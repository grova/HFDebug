<!DOCTYPE html> 
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
--> 
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
		
        <link rel="stylesheet" type="text/css" href="js/y3.theme.css">
        <link rel="stylesheet" type="text/css" href="js/jquery.mobile.icons-1.4.0.css">
        <link rel="stylesheet" type="text/css" href="js/jquery.mobile.structure-1.4.0.css">
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" type="text/css" href="css/tolito-1.0.6.css" />

        
        <script type="text/javascript" src="phonegap.js"></script>
		<script type="text/javascript" src="js/jquery-2.0.3.js"></script>
		<script type="text/javascript" src="js/jquery.mobile-1.4.0.js"></script>
    	
		<script type="text/javascript" src="FileTransfer.js"></script>
		<script type="text/javascript" src="js/index.js"></script>
		<script type="text/javascript" src="js/y3.js"></script>
		<script type="text/javascript" src="js/tolito-1.0.6.js"></script>

		<title>Hello World</title>    
    </head>

    <!--
    // cambio lo startup come da documentazione
    // http://docs.phonegap.com/en/3.3.0/cordova_events_events.md.html#deviceready
	-->

    <body onLoad="mainInit()">
    	
        
        <!--  ======================== LOADING PAGE ============================= !-->
        <div data-role="page" id="loading" data-theme="a" class="y3-gradient-bg">

          <div data-role="content">
            <div class="y3-splash">
            	<img src="img/splash_logo.png"><br>
                <div class="blink">Loading...</div>
             </div>
          </div>
          <div data-role="footer" data-position="fixed" data-theme="b">
          </div><!-- /footer -->
          
        </div><!-- /page --> 
    


        <!--  ======================== TESTING PAGE ============================= !-->
        <div data-role="page" id="testpage" data-theme="a">
        	<div data-role="header" data-position="fixed"><h1>Testing Page</h1></div>
            <div data-role="content">


                <fieldset class="ui-grid-a">
                    <div class="ui-block-a"><p class="y3-testpage-description">Scarica il json dal server</p><input type="button" value="Load Json" data-theme="c" onclick = app.loadJson()></div>

                    <div class="ui-block-b"><p class="y3-testpage-description">Scarica un file pdf dal server e lo salva in locale (chrome).</p><input type="button" value="Download file chrome" data-theme="c" onclick = downloadFileChrome(app.toDownloadList[0])></div>

                    <div class="ui-block-a"><p class="y3-testpage-description">scarico il primo file da aggiornare (mobile)</p><input type="button" value="download mobile" data-theme="c" onclick = app.downloadFile(0)></div>

                    <div class="ui-block-b"><p class="y3-testpage-description">apre con ibooks</p><input type="button" value="ibook open" data-theme="c" onclick = app.openFile(0,true,true)></div>

                    <div class="ui-block-a"><p class="y3-testpage-description">apre il primo file del db locale</p><input type="button" value="load pdf" data-theme="c" onclick = app.openFile(0,false,false)></div>

                    <div class="ui-block-b"><p class="y3-testpage-description">vuota</p><input type="button" value="app to y3" data-theme="c" ></div>

                    <div class="ui-block-a"><p class="y3-testpage-description">Imposta i DB come variabili per debug interfaccia in chrome</p><input type="button" value="y3 DB" data-theme="c" onclick = y3.setDBasVariable()></div>


                    <div class="ui-block-b"><p class="y3-testpage-description">Aggiungo 100 righe ai files</p><input type="button" value="Add 100 files" data-theme="c" onclick = y3.addlines(100)></div>
                </fieldset>            
                    

            </div>

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#homepage" data-icon="arrow-l">Back</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" onClick="y3.initialize('homecontent');" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 



        <!--  ======================== HOME PAGE ============================= !-->
        <div data-role="page" id="homepage" data-theme="a">
        	<div data-role="header" data-position="fixed" style="text-align:center; padding-top:2%;">
            	<img src="img/splash_logo.png" style="width:30%; height:auto;">
            </div>
            
            <div data-role="content" id="homecontent">

            </div>

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#testpage" data-icon="action">Test page</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" class="app-loadJson" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 



        <!--  ======================== FILE LIST ============================= !-->
        <div data-role="page" id="filelist" data-theme="a">
        	<div data-role="header" data-position="fixed">
            	<a href="#homepage" class="ui-btn-left ui-btn ui-btn-inline ui-mini ui-corner-all ui-btn-icon-left ui-icon-back">Back</a>
	            <h1 id="listheader">Cataloghi e Schede Tecniche</h1>
            </div>
            
            <div data-role="content" id="filelistcontent">

				<div class="ui-body"> la lista dei file Ã¨ vuota</div>
                
            </div><!-- /content -->

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#testpage" data-icon="action">Test page</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" class="app-loadJson" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 


        <!--  ======================== DOWNLOAD / UPDATE PAGE ============================= !-->
        <div data-role="page" id="downloading" data-theme="a">
        	<div data-role="header" data-position="fixed">
	            <h1>Download aggiornamenti</h1>
            </div>
            
            <div data-role="content" id="downloading_cnt">
            	<p class="y3-center" style="margin-top:6em;">Download in corso: <span id="actualdownloadingfile">1</span> di <span id="totalnumberoffiles">5</span></p>
            	<div id="progressbarcontainer"></div>
            	
                <div class="button-wrap y3-center" style="margin-top:6em;"><button class="ui-btn ui-btn-inline ui-icon-delete ui-btn-icon-left ui-corner-all ui-btn-b ">Annulla</button></div>

            </div><!-- /content -->

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#testpage" data-icon="action">Test page</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" class="app-loadJson" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 



        <!--  ======================== FILES TO SYNC PAGE ============================= !-->
        <div data-role="page" id="filestosync" data-theme="a">
        	<div data-role="header" data-position="fixed">
	            <h1>Aggiornamenti</h1>
            </div>
            
            <div data-role="content" id="filestosync-cnt">
            
                <div class="ui-corner-all">


                    <p class="y3-center" style="padding-top:6em; padding-bottom:6em; font-size:large;"><span id="filestodownload"></span> files da scaricare<br>
                    <cite style="font-size:small;">possono essere file nuovi o aggiornamenti di file esistenti</cite></p>
                    

                

                  <div class="ui-grid-a">
                    <div class="ui-block-a">
                    	<div class="button-wrap y3-marOriz">
                    		<button onClick="app.mainDownloadAllFiles()" class="ui-btn ui-icon-arrow-d ui-btn-icon-left ui-corner-all ui-btn-c">Scarica</button>
                    	</div>
                    </div>
                    <div class="ui-block-b">
                    	<div class="button-wrap y3-marOriz">
                        	<button onClick="app.requestAbort()" class="ui-btn ui-icon-delete ui-btn-icon-left ui-corner-all ui-btn-b">Annulla</button>
                        </div>
                    </div>
                  </div>                  

                </div>            

            </div><!-- /content -->

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#testpage" data-icon="action">Test page</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" class="app-loadJson" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 



        <!--  ======================== NESSUN FILE DA SCARICARE ============================= !-->
        <div data-role="page" id="no_filestosync" data-theme="a">
        	<div data-role="header" data-position="fixed">
	            <h1>Info</h1>
            </div>
            
            <div data-role="content" id="downloading_cnt">
            	<p class="y3-center" style="margin-top:6em;">Nessun file da aggiornare</p>
            	<div id="progressbarcontainer"></div>
            	
                <div class="button-wrap y3-center" style="margin-top:6em;"><a href="#homepage" class="ui-btn ui-btn-c ui-btn-icon-left ui-icon-check ui-btn-inline ui-corner-all ">Fine</a></div>

            </div><!-- /content -->

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#testpage" data-icon="action">Test page</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" onClick="y3.initialize('homecontent');" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 



        <!--  ======================== DOWNLOAD COMPLETATO ============================= !-->
        <div data-role="page" id="downloadcompleted" data-theme="a">
        	<div data-role="header" data-position="fixed">
	            <h1>Info</h1>
            </div>
            
            <div data-role="content" id="downloading_cnt">
            	<p class="y3-center" style="margin-top:6em;">Download completato con successo</p>
            	<div id="progressbarcontainer"></div>
            	
                <div class="button-wrap y3-center" style="margin-top:6em;"><button class="ui-btn ui-btn-c ui-btn-icon-left ui-icon-check ui-btn-inline ui-corner-all ">Fine</button></div>

            </div><!-- /content -->

            <div data-role="footer" data-position="fixed" data-theme="b">
            	<div data-role="navbar" data-iconpos="top">
                	<ul>
                        <li><a href="#testpage" data-icon="action">Test page</a></li>
                        <li><a href="#" data-icon="gear">Options</a></li>
                        <li><a href="#" onClick="y3.initialize('homecontent');" data-icon="refresh">Sync</a></li>
                        <li><a href="#" class="y3-exitApp" data-icon="power">Exit</a></li>
                    </ul>
                </div><!-- /navbar -->
            </div><!-- /footer -->

		</div><!-- /page --> 





	
        <script type="text/javascript">
        	var g_mainInit = 0;
        	function mainInit()
        	{
        		g_mainInit++;
	            app.initialize();
			
				$(".y3-exitApp").click(function(){
					app.exitapp();
				});

                $(".app-loadJson").click(function(){
                    app.loadJson();
                });
				
				// binda il click sulle voci al link per visualizzare i files
				$("#homecontent").on('click','.filelistlink', function(){
					y3.taglist = $( this ).attr("tags")
					y3.listheader = $( this ).attr("listheader")
					//alert( y3.taglist); //debug
					y3.populatefilelist('filelistcontent',y3.taglist);
					
				});


			}

		</script>


    </body>
</html>
